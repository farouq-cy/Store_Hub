{% extends 'pages/base.html' %}
{% block content %}
<!DOCTYPE html>
{% load static %}
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <link rel="stylesheet" href="{% static 'css/style.css' %}" />
    <link
      rel="stylesheet"
      href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.7.2/css/all.min.css"
      integrity="sha512-Evv84Mr4kqVGRNSgIGL/F/aIDqQb7xQ2vcrdIwxfjThSH8CSR7PBEakCr51Ck+w+/U6swU2Im1vVX0SVk9ABhg=="
      crossorigin="anonymous"
      referrerpolicy="no-referrer" />
    <link
      href="https://unpkg.com/boxicons@2.1.2/css/boxicons.min.css"
      rel="stylesheet" />

    <!--Link Swiper-->
    <link
      rel="stylesheet"
      href="https://unpkg.com/swiper/swiper-bundle.min.css" />
    <title>Store Hub | Main</title>
  </head>

  <body class="light">
   <!-- Section One -->
<section class="slider">
  <div class="container">
    <div class="side_bar">
      <div class="welcome-message">
        {% if user.is_authenticated %}
          <h3>مرحبًا بك، {{ username }}!</h3>
        {% else %}
          <h3>مرحبًا بك في متجرنا!</h3>
        {% endif %}
      </div>
      <a href="{% url 'allproducts' %}?category=Men's Fashion">Men's Fashion</a>
      <a href="{% url 'allproducts' %}?category=Woman's Fashion">Woman's Fashion</a>
      <a href="{% url 'allproducts' %}?category=Electronics">Electronics</a>
      <a href="{% url 'allproducts' %}?category=Medicine">Medicine</a>
      <a href="{% url 'allproducts' %}?category=Phone & Tablet">Phone & Tablet</a>
      <a href="{% url 'allproducts' %}?category=Sportes & Outdoor">Sportes & Outdoor</a>
      <a href="{% url 'allproducts' %}?category=Fashion & Clothings">Fashion & Clothings</a>
      <a href="{% url 'allproducts' %}?category=TV & Audio">TV & Audio</a>

    </div>
    <div class="swiper">
      <div class="swiper-wrapper">
        {% for product in products %}
        <div class="swiper-slide">
          <a href="#"><img src="{{ product.image.url }}" alt="{{ product.name }}"  onclick="window.location.href='/product/{{ product.id }}/'"/></a>
        </div>
        {% endfor %}
      </div>
      <div class="swiper-pagination"></div>
    </div>
  </div>
</section>


    <!--Section Two-->
    <section class="offer">
      <div class="container">
        <div class="dayOffers">
          <span class="shape">.</span>
          <h3>Today's</h3>
        </div>
      </div>
    </section>

  <!--Section There-->
  <section class="timer">
    <div class="container">
      <div class="flex">
        <h2>FLASH SALES</h2>
        <div class="dateAndClock">
          <div class="date">
            <h3>Days</h3>
            <h3>Hours</h3>
            <h3>Minute</h3>
            <h3>Second</h3>
          </div>
          <div class="clock">
            <h2 class="day">00:</h2>
            <h2 class="hour">00:</h2>
            <h2 class="minut">00:</h2>
            <h2 class="second">00</h2>
          </div>
        </div>
      </div>
      <div class="mySwiper">
        <div class="swiper-button-next btn_swip btSwapProNext"></div>
        <div class="swiper-button-prev btn_swip btSwapProPrev"></div>
      </div>
    </div>
  </section>

  <!--Swiper Section Four-->
  <section class="pro-div">
    <div class="container">
      <div class="products mySwiper">
        <div class="product swiper-wrapper">
          {% for pro in flash_sales %}
          <div class="swiper-slide pro">
            <div class="icons">
              <div class="sall">
                <span class="discount"></span>
              </div>
              <div class="icon">
                <i class="fa-regular fa-heart" id="iconheart"></i>
                <i class="fa-regular fa-eye" onclick="window.location.href='/product/{{ pro.product.id }}/'; return false;" ></i>
              </div>
            </div>

            <div class="addcart" data-id="{{ pro.product.id }}">
              <div class="text">
                <p>Add To Cart</p>
              </div>
            </div>
            
            <div class="img">
              <a href="/product/{{ pro.product.id }}/" onclick="window.location.href='/product/{{ pro.product.id }}/'; return false;">
                <img src="{{ pro.product.image.url }}" alt="{{ pro.product.name }}" />
              </a>
            </div>
            
            <div class="detailes">
              <h5>{{ pro.product.name }} </h5>
              <div class="sallery">
                <span class="new-sall">${{ pro.new_price }}  </span>
                <span class="old-sall">${{ pro.old_price }}</span>
              </div>
              <div class="stars">
                {% for _ in "12345"|make_list %}
                  {% if forloop.counter <= pro.rating|floatformat:0 %}
                    <i class="fa-solid fa-star"></i>
                  {% else %}
                    <i class="fa-regular fa-star"></i>
                  {% endif %}
                {% endfor %}
                <span>({{ pro.rating|floatformat:1 }})</span>
              </div>
            </div>
          </div>
          {% endfor %}
        </div>
      </div>
    </div>
  </section>
    <!--Section Five-->
    <section>
      <div class="container">
        <div class="bttnAllProduct">
          <a href="{% url 'allproducts' %}">
            <button>View All Products</button>
          </a>
        </div>
      </div>
    </section>

    <!--Section Six-->
    <section id="browseCat">
      <div class="container">
        <div class="browseCat">
          <div class="categText">
            <span class="shape">.</span>
            <h3>Categories</h3>
          </div>
          <div class="catbtnswap mySwiper">
            <h3>Browse By Category</h3>
            <div class="swiper-button-next btn_swip btnSwapNext"></div>
            <div class="swiper-button-prev btn_swip BtnSwapPrev"></div>
          </div>
        </div>
        <div class="categs mySwiper">
          <div class="categ swiper-wrapper">
            <div class="categ swiper-slide">
              <div class="cat">
                <h2>Phones</h2>
                <i class="fa-solid fa-mobile"></i>
              </div>
            </div>
            <div class="categ swiper-slide">
              <div class="cat">
                <h2>Computers</h2>
                <i class="fa-solid fa-tv"></i>
              </div>
            </div>
            <div class="categ swiper-slide">
              <div class="cat">
                <h2>Camera</h2>
                <i class="fa-solid fa-camera"></i>
              </div>
            </div>
            <div class="categ swiper-slide">
              <div class="cat">
                <h2>HeadPhones</h2>
                <i class="fa-solid fa-headphones"></i>
              </div>
            </div>
            <div class="categ swiper-slide">
              <div class="cat">
                <h2>Gaming</h2>
                <i class="fa-solid fa-keyboard"></i>
              </div>
            </div>
          </div>
        </div>
      </div>
    </section>

    <!--Section Seven-->
    <section class="BestSellingProducts">
      <div class="container">
        <div class="top">
          <div class="shape-text">
            <span class="shape">.</span>
            <h5 class="txt">This Month</h5>
          </div>
          <div class="bttn">
            <h4>Top liked Products</h4>
            <a href="{% url 'allproducts' %}">
              <button>View All</button>
            </a>
          </div>
        </div>
        
        <div class="bttom">
          {% for product in products %}
          <div class="pro"  >
            <div class="icons">
              <div class="icon">
                <i class="fa-regular fa-heart" id="iconheart"></i>
                <i class="fa-regular fa-eye" onclick="window.location.href='/product/{{ product.id }}/'" ></i>
              </div>
            </div>
            <div class="addcart" data-id="{{ product.id }}">
              <div class="text">
                <p>Add To Cart</p>
              </div>
            </div>
            
            <div class="img"  >
              <a href="/product/{{ product.id }}/">
                <img src="{{ product.image.url }}" alt=""  onclick="window.location.href='/product/{{ product.id }}/'"  />
              </a>
            </div>
            <div class="detailes">
              <h5>{{  product.name  }}</h5>
              <div class="sallery">
                <span class="new-sall">${{  product.price  }}</span>
              </div>
              <div class="stars">
                <i class="fa-solid fa-star"></i>
                <i class="fa-solid fa-star"></i>
                <i class="fa-solid fa-star"></i>
                <i class="fa-solid fa-star"></i>
                <i class="fa-solid fa-star"></i>
                <span>(88)</span>
              </div>
            </div>
          </div>{% endfor %}
      </div>
    </section>
    <script>
      document.addEventListener("DOMContentLoaded", function () {
        let endTime = "{{ max_time|date:'Y-m-d H:i:s' }}";
    
        if (endTime) {
          endTime = new Date(endTime).getTime();
    
          function updateTimer() {
            let now = new Date().getTime();
            let timeLeft = endTime - now;
    
            if (timeLeft > 0) {
              let days = Math.floor(timeLeft / (1000 * 60 * 60 * 24));
              let hours = Math.floor((timeLeft % (1000 * 60 * 60 * 24)) / (1000 * 60 * 60));
              let minutes = Math.floor((timeLeft % (1000 * 60 * 60)) / (1000 * 60));
              let seconds = Math.floor((timeLeft % (1000 * 60)) / 1000);
    
              document.querySelector(".day").innerHTML = (days < 10 ? "0" : "") + days + ":";
              document.querySelector(".hour").innerHTML = (hours < 10 ? "0" : "") + hours + ":";
              document.querySelector(".minut").innerHTML = (minutes < 10 ? "0" : "") + minutes + ":";
              document.querySelector(".second").innerHTML = (seconds < 10 ? "0" : "") + seconds;
            } else {
              document.querySelector(".timer").innerHTML = "<h2>FLASH SALES ENDED</h2>";
            }
          }
    
          setInterval(updateTimer, 1000);
          updateTimer();
        } else {
          document.querySelector(".timer").innerHTML = "<h2>No Flash Sales Available</h2>";
        }
      });
    </script>
    <script src="https://unpkg.com/swiper/swiper-bundle.min.js"></script>
    <script src="{% static 'js/test.js' %}"></script>
  </body>
  
</html>
{% endblock content %}
